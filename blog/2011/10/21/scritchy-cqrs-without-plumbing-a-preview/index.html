
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Scritchy: CQRS without plumbing - a preview - Tom's ramblings</title>
	<meta name="author" content="Tom Janssens">

	
	<meta name="description" content="Scritchy: CQRS Without Plumbing - a Preview Introduction
CQRS is one of my architectural pet peeves, as you might have noticed from the numerous &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Tom's ramblings" type="application/atom+xml">
	
	<link rel="canonical" href="http://ToJans.github.io/blog/2011/10/21/scritchy-cqrs-without-plumbing-a-preview/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("tom@corebvba.be") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
</div>
<hgroup>
  <h1><a href="/">Tom's ramblings</a></h1>
  
    <p class="subtitle">Random opinionated blurbs</p>
  
</hgroup>

<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About Tom</a></li>
</ul>


<section class="aboutme">
  <p>
    <p>Tom builds software and helps organisations to get better at building software.</p>

  </p>
</section>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/tojans" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/tojans" title="GitHub">GitHub</a>
		
		
		
		<a class="linkedin" href="http://www.linkedin.com/in/tomjanssens">LinkedIn</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Scritchy: CQRS Without Plumbing - a Preview</h1>
	<div class="entry-content" itemprop="articleBody"><h3>Introduction</h3>
<p><a href="http://martinfowler.com/bliki/CQRS.html">CQRS</a> is one of my architectural pet peeves, as you might have noticed<a href="http://www.corebvba.be/blog/?tag=/CQRS"> from the numerous amount of blog posts I made on this subject</a>. However, I noticed the concept is complicated and hard to grasp for newcomers to CQRS. I have been spiking numerous attempts of a framework that makes CQRS both more manageable and understandable, failed hundreds of times, and even published a few of my acceptable attempts as gists <a href="https://github.com/tojans">over at github</a>&#8230;</p>
<p>A few days ago I was messing around with <a href="http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx" target="_blank">SignalR</a> trying to setup again another CQRS attempt, and failed miserably&#8230;. However, 2 nights after that approach I had an ephiphany which had been lingering around in my head ever since.</p>
<p>Today I decided to get back to business, so this afternoon I started spiking a proof of concept (POC).</p>
<p>I think you will be happy to see that I managed to get most of the annoyance out of CQRS with this simple concept.</p>
<p></p>
<h3>Show me the codez !!!</h3>
<p>Before I show you the codes, I would like to mention a few things, since it is a POC:</p>
<ul>
<li>My eventstore is currently implemented as a List of objects. While this works for this concept, you can imagine that this might get you into trouble</li>
<li>The Aggregate roots get completely rebuilt every single time (no cache), so the app might get a litlle bit slow when you push numerous commands to it</li>
<li>The concept is completely synchronous, but making it asynchronous should be effortless.</li>
<li>The functionality I talked about in these 3 points are currently implemented as overrides of the abstract class ScratchBus, which requires you to override the function to load an ar, and to replay events on an object. As there are some nice alternatives available, I am not planning on reimplementing them, but for now I opt for <a href="http://www.corebvba.be/blog/post/Continuous-thinking-just-ship-it-the-story-of-NerdBeers.aspx">the simplest thing that could possibly work</a>.</li>
<li><span style="text-decoration: line-through;">I am currently still thinking about conventions for the viewmodels as these conventions need to provide more flexibiltity then just EVENT/AR.ID binding&#8230; I am not sure whether I will find an acceptable solution on that matter&#8230;</span>&nbsp;<strong>Update:</strong> KISS as usual, view instances are built/modified by stateless handlers; piece of cake !</li>
</ul>
<div>Anyway, enough stalling, here we go:</div>
<p>
<script src="https://gist.github.com/1304066.js"></script>
</p>
<p>This is the only code required to get a fully working AR with events&#8230; IMO it looks pretty clean. As you might have guessed there are some conventions used in order to get the plumbing out of the way.</p>
<p>What do you think ? Pretty clean I would assume ?</p>
<h3>Sold! Where can I get it ?</h3>
<p><span style="text-decoration: line-through;">Depending on the feedback I get, I might push it online <a href="https://github.com/tojans" target="_blank">over at my github account</a>, but for now, I would rather try to find a good solution for the viewmodel/event conventions</span>.</p>
<p><strong>Update:</strong> I published the sourcecode <a href="https://github.com/ToJans/Scritchy" target="_blank">over at my github account</a>.</p>
<p><strong>Update 2:</strong> Whenever I push the source to github, the <a href="http://scritchyexample.apphb.com/" target="_blank">demo at appharbor</a> gets updated as well automagically.</p>
<p>Feel free to PM me any time (or tweet; <a href="http://twitter.com/#/tojans" target="_blank">@tojans</a> )&#8230;</p>
<h3>Conclusion</h3>
<p>While this is still a work in progress, and nowhere near ready for production usage, I think this might actually be a pretty cool implementation. If I can somehow find a way to complete this framework, I think I might be on to something here.</p>
<p>I am aware that CQRS is considered to complicated by some, and I am aware that some experts advise against the usage of CQRS in most cases.&nbsp;However, it is my opinion that CQRS provides you with a proper template for development, where everything is nicely separated the way it is supposed to be, and easily adjustable. Another motivation for the CQRS approach is the spaghetti-code of the nillies, currently also known as lasagna-code: numerous amounts of layers over layers that make adding a simple field to a screen a few days of work.</p>
<p>By providing Scritchy, I am trying to find a way to make CQRS not only working, but also relatively easy to use and understand.</p>
<p>This is not the end, but the beginning of a new path&#8230;</p><div style="text-align:right"><a class="addthis_button" href="http://www.addthis.com/bookmark.php?v=250&amp;pub=xa-4aec37702e3161d4"><img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"/></a><script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pub=xa-4aec37702e3161d4"></script></div>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - Tom Janssens -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'tojansramblings';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-41936060-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




		</div>
	</div>
</body>
</html>
